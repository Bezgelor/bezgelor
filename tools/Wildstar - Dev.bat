@echo off
cd /d "C:\Program Files (x86)\NCSOFT\WildStar\Client64"
powershell.exe -ExecutionPolicy Bypass -NoProfile -Command "Add-Type 'using System; using System.Runtime.InteropServices; public class PL { [StructLayout(LayoutKind.Sequential)] public struct SI { public int cb; public string a,b,c; public int d,e,f,g,h,i,j,k; public short l,m; public IntPtr n,o,p,q; } [StructLayout(LayoutKind.Sequential)] public struct PI { public IntPtr a,b; public int c,d; } [DllImport(\"kernel32.dll\",CharSet=CharSet.Unicode)] public static extern bool CreateProcess(string a,string b,IntPtr c,IntPtr d,bool e,uint f,IntPtr g,string h,ref SI i,out PI j); public static void Run(string exe,string args) { SI si=new SI(); si.cb=System.Runtime.InteropServices.Marshal.SizeOf(si); PI pi; CreateProcess(exe,args,IntPtr.Zero,IntPtr.Zero,false,0,IntPtr.Zero,null,ref si,out pi); } }'; [PL]::Run('WildStar64.exe','/auth 10.1.0.98 /authNc 10.1.0.98 /lang en /patcher 10.1.0.98 /SettingsKey WildStar /realmDataCenterId 9')"
